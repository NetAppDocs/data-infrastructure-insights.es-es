---
sidebar: sidebar 
permalink: task_create_query.html 
summary: Las consultas permiten identificar de forma rápida y sencilla activos y métricas de interés. 
keywords: query, queries 
---
= Creación de consultas
:hardbreaks:
:allow-uri-read: 


[role="lead"]
Las consultas le permiten buscar los activos de su inquilino a un nivel granular, lo que le permite filtrar los datos que desea y ordenar los resultados a su gusto.

Por ejemplo, puede crear una consulta para _volúmenes_, agregar un filtro para encontrar _almacenes_ específicos asociados con los volúmenes seleccionados, agregar otro filtro para encontrar una _anotación_ particular como "Nivel 1" en los almacenamientos seleccionados y, finalmente, agregar otro filtro para encontrar todos los almacenamientos con _IOPS - Lectura (IO/s)_ mayor a 25.  Cuando se muestren los resultados, podrá ordenar las columnas de información asociadas con la consulta en orden ascendente o descendente.

Nota: Cuando se agrega un nuevo recopilador de datos que adquiere activos, o se realizan anotaciones o asignaciones de aplicaciones, puede consultar esos nuevos activos, anotaciones o aplicaciones solo después de que se indexen las consultas.  La indexación se produce en un intervalo programado regularmente o durante ciertos eventos, como la ejecución de reglas de anotación.

.Crear una consulta es muy sencillo:
. Vaya a *Consultas > *+Nueva consulta*.
. Desde la lista 'Seleccionar...', seleccione el tipo de objeto que desea consultar.  Puede desplazarse por la lista o comenzar a escribir para encontrar más rápidamente lo que está buscando.


.Lista de desplazamiento:
image:QueryDrop-DownList.png["Consulta desplegable"]

.Escribir para buscar:
image:QueryPageFilter.png["Escribiendo para encontrar"]

Puede agregar filtros para limitar aún más su consulta haciendo clic en el botón *+* en el campo *Filtrar por*.  Agrupar filas por objeto o atributo.  Al trabajar con datos de integración (Kubernetes, ONTAP Advanced Metrics, etc.), puede agruparlos por múltiples atributos, si lo desea.

image:QueryFilterExample.png["Filtrado y agrupación de consultas"]

La lista de resultados de la consulta muestra una serie de columnas predeterminadas, según el tipo de objeto buscado.  Para agregar, eliminar o cambiar las columnas, haga clic en el ícono de engranaje a la derecha de la tabla.  Las columnas disponibles varían según el tipo de activo/métrica.

image:QuerySelectColumns.png["Seleccionar columnas"]



== Véalo en acción

link:https://media.netapp.com/video-detail/d0530e0b-a222-52e7-92b1-dbeeee41b712/explore-and-analyze-with-queries-in-data-infrastructure-insights["Explorar y analizar con consultas en Data Infrastructure Insights (Video)"]



== Selección de agregación, unidades y formato condicional



=== Agregación y unidades

Para las columnas de "valor", puede refinar aún más los resultados de su consulta eligiendo cómo se agregan los valores mostrados, así como seleccionando las unidades en que se muestran esos valores.  Estas opciones se encuentran seleccionando el menú de “tres puntos” en la esquina superior de una columna.

image:Query_Page_Aggregation_etc.png["Resultados de la página de consulta que muestran agregación, formato condicional, visualización de unidades y cambio de nombre de columnas"]



==== Unidades

Puede seleccionar las unidades en las que desea mostrar los valores.  Por ejemplo, si la columna seleccionada muestra la capacidad bruta y los valores se muestran en GiB, pero prefiere mostrarlos como TiB, simplemente seleccione TiB en el menú desplegable Visualización de unidades.



==== Agregación

De la misma manera, si los valores mostrados se agregan a partir de los datos subyacentes como "Promedio", pero prefiere mostrar la suma de todos los valores, seleccione "Suma" en el menú desplegable _Agrupar por_ (si desea que los valores agrupados muestren las sumas) o en el menú desplegable _Agregar por tiempo_ (si desea que los valores de las filas muestren sumas de los datos subyacentes).

Puede elegir agregar puntos de datos agrupados por _Promedio, Máx., Mín. o Suma_.

Puede agregar datos de filas individuales por _Promedio, Último punto de datos adquirido, Máximo, Mínimo o Suma_.



==== Formato condicional

El formato condicional le permite resaltar los umbrales de nivel de advertencia y nivel crítico en la lista de resultados de la consulta, lo que brinda visibilidad instantánea a valores atípicos y puntos de datos excepcionales.

image:Query_Page_Conditional_Formatting.png["Formato condicional en la página de consulta"]

El formato condicional se establece por separado para cada columna.  Por ejemplo, puede elegir un conjunto de umbrales para una columna de capacidad y otro conjunto para una columna de rendimiento.



==== Cambiar nombre de columna

Al cambiar el nombre de una columna, se cambia el nombre que se muestra en la lista de resultados de la consulta.  El nuevo nombre de la columna también se muestra en el archivo resultante si exporta la lista de consultas a .CSV.



=== Ahorrar

Después de haber configurado su consulta para mostrarle los resultados que desea, puede hacer clic en el botón *Guardar* para guardar la consulta para uso futuro.  Dale un nombre significativo y único.



== Más sobre el filtrado



=== Comodines y expresiones

Cuando filtra texto o valores de lista en consultas o widgets del panel, a medida que comienza a escribir se le presenta la opción de crear un *filtro comodín* basado en el texto actual.  Al seleccionar esta opción se devolverán todos los resultados que coincidan con la expresión comodín.  También puede crear *expresiones* usando NOT u OR, o puede seleccionar la opción "Ninguno" para filtrar valores nulos en el campo.

image:Type-Ahead-Example-ingest.png["Filtro comodín"]

Los filtros basados en comodines o expresiones (por ejemplo, NO, O, "Ninguno", etc.) se muestran en azul oscuro en el campo de filtro.  Los elementos que seleccione directamente de la lista se muestran en azul claro.

image:Type-Ahead-Example-Wildcard-DirectSelect.png["Resultados del filtro comodín"]

Tenga en cuenta que el filtrado de comodines y expresiones funciona con texto o listas, pero no con números, fechas o valores booleanos.



=== Filtros de refinación

Puede utilizar lo siguiente para refinar su filtro:

|===


| Filtrar | Qué hace | Ejemplo | Resultado 


| * (Asterisco) | te permite buscar todo | vol*rhel | devuelve todos los recursos que comienzan con "vol" y terminan con "rhel" 


| ?  (signo de interrogación) | le permite buscar un número específico de caracteres | BOS-PRD??-S12 | devuelve BOS-PRD**__12__**-S12, BOS-PRD**__23__**-S12, y así sucesivamente 


| O | le permite especificar múltiples entidades | FAS2240 O CX600 O FAS3270 | devuelve cualquiera de los modelos FAS2440, CX600 o FAS3270 


| NO | le permite excluir texto de los resultados de búsqueda | NO EMC* | devuelve todo lo que no comience con "EMC" 


| _Ninguno_ | busca valores NULL en todos los campos | _Ninguno_ | devuelve resultados donde el campo de destino está vacío 


| No * | busca valores NULL en campos _solo texto_ | No * | devuelve resultados donde el campo de destino está vacío 
|===
Si encierra una cadena de filtro entre comillas dobles, Insight trata todo lo que esté entre la primera y la última comilla como una coincidencia exacta.  Cualquier carácter especial u operador dentro de las comillas se tratará como literal.  Por ejemplo, filtrar por "*" devolverá resultados que son un asterisco literal; el asterisco no se tratará como un comodín en este caso.  Los operadores OR y NOT también se tratarán como cadenas literales cuando estén entre comillas dobles.



=== Filtrado de valores booleanos

Al filtrar un valor booleano, es posible que se le presenten las siguientes opciones para filtrar:

* *Cualquiera*: Esto devolverá _todos_ los resultados, incluidos los resultados configurados como "Sí", "No" o no configurados en absoluto.
* *Sí*: Devuelve sólo resultados "Sí". Tenga en cuenta que DII muestra "Sí" como una marca de verificación en la mayoría de las tablas. Los valores se pueden establecer en "Verdadero", "Activado", etc.; DII trata todos estos como "Sí".
* *No*: Devuelve sólo resultados "No". Tenga en cuenta que DII muestra "No" como una "X" en la mayoría de las tablas. Los valores se pueden establecer en "Falso", "Desactivado", etc.; DII trata todos estos como "No".
* *Ninguno*: Devuelve solo resultados en los que no se ha establecido ningún valor. También conocidos como valores "Nulos".




== ¿Qué hago ahora que tengo los resultados de la consulta?

La consulta proporciona un lugar sencillo para agregar anotaciones o asignar aplicaciones a los activos.  Tenga en cuenta que solo puede asignar aplicaciones o anotaciones a sus activos de inventario (disco, almacenamiento, etc.).  Las métricas de integración no pueden asumir anotaciones ni asignaciones de aplicaciones.

Para asignar una anotación o aplicación a los activos resultantes de su consulta, simplemente seleccione el/los activo(s) utilizando la columna de casilla de verificación a la izquierda de la tabla de resultados, luego haga clic en el botón *Acciones masivas* a la derecha.  Seleccione la acción que desea aplicar a los activos seleccionados.

image:QueryVolumeBulkActions.png["Ejemplo de acciones masivas de consulta"]



== Las reglas de anotación requieren consulta

Si está configurandolink:task_create_annotation_rules.html["Reglas de anotación"] , cada regla debe tener una consulta subyacente con la que trabajar.  Pero como has visto anteriormente, las consultas pueden hacerse tan amplias o tan específicas como necesites.

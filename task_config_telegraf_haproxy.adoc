---
sidebar: sidebar 
permalink: task_config_telegraf_haproxy.html 
keywords: telegraf, installation, install, haproxy 
summary: Configuración del recopilador de datos HAProxy 
---
= Recopilador de datos HAProxy
:hardbreaks:
:allow-uri-read: 


[role="lead"]
Data Infrastructure Insights utiliza este recopilador de datos para recopilar métricas de HAProxy.



== Instalación

. Desde *Observabilidad > Recopiladores*, haga clic en *+Recopilador de datos*.  Elija HAProxy.
+
Seleccione el sistema operativo o la plataforma en la que está instalado el agente Telegraf.

. Si aún no ha instalado un Agente para la recopilación, o desea instalar un Agente para un Sistema operativo o Plataforma diferente, haga clic en _Mostrar instrucciones_ para expandir lalink:task_config_telegraf_agent.html["Instalación del agente"] instrucciones.
. Seleccione la clave de acceso del agente para utilizarla con este recopilador de datos.  Puede agregar una nueva clave de acceso de agente haciendo clic en el botón *+ Clave de acceso de agente*.  Práctica recomendada: utilice una clave de acceso de agente diferente solo cuando desee agrupar recopiladores de datos, por ejemplo, por sistema operativo o plataforma.
. Siga los pasos de configuración para configurar el recopilador de datos.  Las instrucciones varían según el tipo de sistema operativo o plataforma que esté utilizando para recopilar datos.


image:HAProxyDCConfigLinux.png["Configuración de HAProxy"]



== Configuración

El complemento de Telegraf para HAProxy depende de la habilitación de HAProxy Stats.  Esta es una configuración incorporada en HAProxy pero no está habilitada de fábrica.  Cuando está habilitado, HAProxy expondrá un punto final HTML que puede verse en su navegador o extraerse para extraer el estado de todas las configuraciones de HAProxy.



=== Compatibilidad:

La configuración se desarrolló contra HAProxy versión 1.9.4.



=== Configuración:

Para habilitar las estadísticas, edite su archivo de configuración de haproxy y agregue las siguientes líneas después de la sección "valores predeterminados", utilizando su propio usuario/contraseña y/o URL de haproxy:

[listing]
----
stats enable
stats auth myuser:mypassword
stats uri  /haproxy?stats
----
El siguiente es un archivo de configuración de ejemplo simplificado con estadísticas habilitadas:

[listing]
----
global
  daemon
  maxconn 256

defaults
  mode http
  stats enable
  stats uri /haproxy?stats
  stats auth myuser:mypassword
  timeout connect 5000ms
  timeout client 50000ms
  timeout server 50000ms

frontend http-in
  bind *:80
  default_backend servers

frontend http-in9080
  bind *:9080
  default_backend servers_2

backend servers
  server server1 10.128.0.55:8080 check ssl verify none
  server server2 10.128.0.56:8080 check ssl verify none

backend servers_2
  server server3 10.128.0.57:8080 check ssl verify none
  server server4 10.128.0.58:8080 check ssl verify none
----
Para obtener instrucciones completas y actualizadas, consulte lalink:https://cbonte.github.io/haproxy-dconv/1.8/configuration.html#4-stats%20enable["Documentación de HAProxy"] .



== Objetos y contadores

Se recogen los siguientes objetos y sus contadores:

[cols="<.<,<.<,<.<,<.<"]
|===
| Objeto: | Identificadores: | Atributos: | Puntos de datos: 


| Interfaz HAProxy | Proxy de dirección de espacio de nombres | IP del nodo Nombre del nodo ID de proxy Modo ID de proceso Límite de velocidad de sesiones ID de servidor Límite de sesiones Estado | Bytes de entrada Bytes de salida Hits de caché Búsquedas de caché Bytes de compresión Bytes omitidos Compresión Bytes de entrada Compresión Bytes de salida Compresión Respuestas Tasa de conexión Tasa de conexión Conexiones máximas Total de solicitudes denegadas por regla de conexión Solicitudes denegadas por problemas de seguridad Respuestas denegadas por problemas de seguridad Solicitudes denegadas por regla de sesión Errores de solicitudes Respuestas 1xx Respuestas 2xx Respuestas 3xx Respuestas 4xx Respuestas 5xx Respuestas Otras solicitudes interceptadas Tasa de sesiones Tasa de sesiones Tasa de solicitudes máximas Tasa de solicitudes Tasa de solicitudes máximas Total de sesiones Sesiones máximas Sesiones Total de solicitudes Reescrituras 


| Servidor HAProxy | Servidor proxy de direcciones de espacio de nombres | IP del nodo Nombre del nodo Verificar tiempo para finalizar Verificar configuración de caída Verificar valor de salud Verificar configuración de subida Verificar estado ID de proxy Hora del último cambio Hora de la última sesión Modo ID de proceso ID de servidor Estado Peso | Servidores activos Servidores de respaldo Bytes de entrada Bytes de salida Desactivaciones de comprobación Errores de comprobación Conexiones de cliente Tiempo promedio de conexión Tiempo de inactividad Total de respuestas denegadas Errores de conexión Errores de respuesta Respuestas 1xx Respuestas 2xx Respuestas 3xx Respuestas 4xx Respuestas 5xx Respuestas Otro servidor seleccionado Cola total Cola actual Tiempo promedio máximo de cola Sesiones por segundo Sesiones por segundo Tiempo máximo de respuesta de reutilización de conexión Promedio de sesiones Sesiones Transferencia máxima de servidor Aborta sesiones Sesiones totales Tiempo total promedio de solicitudes Redespaciados Solicitudes Reintentos Solicitudes Reescrituras 


| Backend de HAProxy | Proxy de dirección de espacio de nombres | IP del nodo Nombre del nodo ID de proxy Hora del último cambio Hora de la última sesión Modo ID de proceso ID de servidor Límite de sesiones Estado Peso | Servidores activos Servidores de respaldo Bytes de entrada Bytes de salida Aciertos de caché Búsquedas de caché Desactivaciones de cliente Anulaciones de cliente Bytes de compresión omitidos Bytes de compresión de entrada Bytes de compresión de salida Respuestas de compresión Conexiones Tiempo promedio de conexión Tiempo de inactividad Total de solicitudes denegadas por problemas de seguridad Respuestas denegadas por problemas de seguridad Errores de conexión Errores de respuesta Respuestas 1xx Respuestas 2xx Respuestas 3xx Respuestas 4xx Respuestas 5xx Respuestas Otro servidor seleccionado Cola total Cola actual Tiempo promedio máximo de cola Sesiones por segundo Sesiones por segundo Máximo de solicitudes Reutilización total de conexión Tiempo de respuesta Promedio de sesiones Sesiones Máximo de anulaciones de transferencia de servidor Sesiones Total de sesiones Tiempo total Promedio de solicitudes Redespaciados Solicitudes Reintentos Solicitudes Reescrituras 
|===


== Solución de problemas

Información adicional se puede encontrar en ellink:concept_requesting_support.html["Soporte"] página.
